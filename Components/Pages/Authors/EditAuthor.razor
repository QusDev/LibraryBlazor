@page "/authors/edit/{Id:int}";
@inject IAuthorService authorService;
@inject NavigationManager navigationManager;

<h2 class="mb-3">Create author</h2>

@if (Author == null)
{
    <p><em>Not found author with id: @Id</em></p>
}
else
{
    <EditForm Model="Author" FormName="createAuthor" OnValidSubmit="@OnFormSubmitAsync">
        <DataAnnotationsValidator />

        <div class="form-group mb-3">
            <label>First Name</label>
            <InputText @bind-Value=Author.FirstName class="form-control" placeholder="Enter first name">@Author.FirstName</InputText>
            <ValidationMessage For="@(() => Author.FirstName)" />
        </div>

        <div class="form-group mb-3">
            <label>Last Name</label>
            <InputText @bind-Value=Author.LastName class="form-control" placeholder="Enter last name">@Author.LastName</InputText>
            <ValidationMessage For="@(() => Author.LastName)" />
        </div>

        <div class="form-group">
            <button type="submit" class="btn btn-success">Submit</button>
            <NavLink href="/authors"><button type="button" class="btn btn-danger">Cancel</button></NavLink>
        </div>

    </EditForm>
}


@code {
    [Parameter]
    public int Id { get; set; }

    [SupplyParameterFromForm]
    public Author Author { get; set; } = new Author();

    protected override async Task OnInitializedAsync()
    {
        Author = await authorService.GetAsync(Id);
    }

    public async Task OnFormSubmitAsync()
    {
        await authorService.UpdateAsync(Id, Author);
        navigationManager.NavigateTo("/authors");
    }
}
